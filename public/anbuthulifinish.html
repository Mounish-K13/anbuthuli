<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Blood Donation - ANBU THULI</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
  <style>
    body { margin: 0; font-family: Copperplate, Papyrus, fantasy; color: white; }
    nav { display: flex; justify-content: space-between; align-items: center; background: rgba(0,0,0,0.9); padding: 10px 20px; position: sticky; top: 0; z-index: 1000; }
    .logo { font-weight: bold; font-size: 1.2rem; color: #b30000; letter-spacing: 2px; }
    nav .nav-links { display: flex; gap: 8px; }
    nav .nav-links button { padding: 6px 12px; background: #b30000; color: white; border: none; border-radius: 15px; cursor: pointer; font-weight: bold; }
    nav .nav-links button:hover, nav .nav-links button.active { background: #ffcc00; color: #000; }
    section { display: none; padding: 40px 20px; min-height: 90vh; }
    section.active { display: block; }
    #home { background: url('https://surgmedia.com/wp-content/uploads/2020/10/2171-blood-donation.jpg') center/cover no-repeat; text-align: center; }
    #home h1 { font-size: 42px; color: #ffcc00; margin: 20px 0; }
    .register-btn { display: inline-block; margin: 10px; padding: 10px 24px; font-size: 16px; color: white; background: linear-gradient(45deg, #ff0000, #b30000); border-radius: 30px; text-decoration: none; font-weight: bold; }
    .form-container { max-width: 500px; margin: auto; background: #111; padding: 20px; border-radius: 10px; }
    .form-container h1 { text-align: center; color: #ffcc00; }
    .form-container label { display: block; margin-top: 12px; }
    .form-container input { margin-top: 6px; }
    .form-container input[type="text"], .form-container input[type="number"], .form-container input[type="password"], .form-container input[type="email"] {
      width: 100%; padding: 8px; border-radius: 6px; border: none; margin-bottom: 10px;
    }
    .form-container button { margin-top: 15px; width: 100%; padding: 10px; background: #b30000; color: white; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; }
    .form-container button:hover { background: #ffcc00; color: #000; }
    #info .hero { text-align: center; padding: 25px; background: url('https://media.istockphoto.com/id/1320162065/vector/blood-cells-red-erythrocytes.jpg?s=612x612&w=0&k=20&c=rX8kGwiOsHW-V-BOal3Cf6ADKdjx_U5snDdykya0jbs=') center/cover; }
    #info .container { display: grid; grid-template-columns: repeat(auto-fit, minmax(240px,1fr)); gap: 20px; padding: 20px; }
    .card { background: #222; border-radius: 10px; padding: 15px; text-align: center; }
    .card i { font-size: 2rem; color: #ffcc00; }
    .card h2 { margin: 10px 0; color: white; }
    .card p, .card ul { font-size: 0.9rem; color: #ccc; }
    #about { background: url('https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTqIhrJsojNi3B04vlP8jjQE5VcHCXQhOCUTQ&s') center/cover fixed; position: relative; text-align: center; }
    #about::before { content: ""; position: absolute; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.6); }
    #about * { position: relative; z-index: 2; }
    #contact .contact-container { max-width: 700px; margin: auto; background: #181818; padding: 20px; border-radius: 10px; }
    footer { text-align: center; background: #000; padding: 15px; font-size: 0.9rem; }
  </style>
</head>
<body>

  <!-- NAVBAR -->
  <nav>
    <div class="logo">ANBU THULI</div>
    <div class="nav-links">
      <button onclick="showPage('home')">Home</button>
      <button onclick="showPage('info')">Info</button>
      <button onclick="showPage('about')">About Us</button>
      <button onclick="showPage('feedback')">Feedback</button>
      <button onclick="showPage('contact')">Contact</button>
      <button onclick="showPage('hospital-register')">Hospital Register</button>
      <button onclick="showPage('hospital-login')">Hospital Login</button>
    </div>
  </nav>

  <!-- HOME -->
  <section id="home" class="active">
    <h1>DONATE BLOOD<br>SAVE LIFE</h1>
    <a href="#" onclick="showPage('donor-register')" class="register-btn">Register as Donor</a>
    <a href="#" onclick="showPage('hospital-register')" class="register-btn">Register as Hospital</a>
    <a href="#" onclick="showPage('hospital-login')" class="register-btn">Hospital Login</a>
  </section>

  <!-- INFO -->
  <section id="info">
    <div class="hero">
      <h1>Donate Blood, Save Life</h1>
      <p>Learn why blood donation matters, who can donate, and how you can help save lives.</p>
    </div>
    <div class="container">
      <div class="card"><i class="fas fa-hand-holding-heart"></i><h2>Why Donate?</h2><p>Every 2 seconds, someone needs blood. One unit can save 3 lives.</p></div>
      <div class="card"><i class="fas fa-star-of-life"></i><h2>Benefits</h2><ul><li>Saves lives</li><li>Helps patients</li><li>Keeps heart healthy</li><li>Free health check</li></ul></div>
      <div class="card"><i class="fas fa-user-check"></i><h2>Eligibility</h2><ul><li>Ages 18–60</li><li>Weight 50kg+</li><li>Hemoglobin ≥ 12.5</li></ul></div>
      <div class="card"><i class="fas fa-hospital"></i><h2>Process</h2><p>Safe, quick (15–20 mins) by trained staff.</p></div>
    </div>
  </section>

  <!-- ABOUT -->
  <section id="about">
    <h1>About Us</h1>
    <p><b>ANBU THULI</b> is a non-profit initiative started by volunteers to promote blood donation and connect donors with hospitals quickly.</p>
    <h3>Our Founders</h3>
    <ul><li>Mohammed Harries A</li><li>Mohan Kumar M</li><li>Mounish K</li><li>Pranesh H</li><li>Prathekaa M</li></ul>
  </section>

  <!-- FEEDBACK -->
  <section id="feedback">
    <h1>Feedback</h1>
    <form class="form-container" onsubmit="alert('Thank you for your feedback!'); return false;">
      <label>Your Name</label><input type="text" required>
      <label>Your Email</label><input type="email" required>
      <label>Your Feedback</label><input type="text" required>
      <button type="submit">Submit Feedback</button>
    </form>
  </section>

  <!-- CONTACT -->
  <section id="contact">
    <h1>Contact Us</h1>
    <div class="contact-container">
      <p>Reach out for queries:</p>
      <div><i class="fas fa-phone"></i> +91 98765 43210</div>
      <div><i class="fas fa-envelope"></i> support@anbuthuli.org</div>
      <div><i class="fas fa-map-marker-alt"></i> Coimbatore, Tamil Nadu</div>
    </div>
  </section>

  <!-- DONOR REGISTER -->
  <section id="donor-register">
    <div class="form-container">
      <h1>Donor Registration</h1>
      <form id="donorForm">
        <label>Full Name</label><input type="text" id="donorName" required>
        <label>Age</label><input type="number" id="donorAge" required>
        <label>Blood Group</label><input type="text" id="donorBloodGroup" required>
        <label>Phone</label><input type="text" id="donorPhone" required>
        <label>Password</label><input type="password" id="donorPassword" required>
        <label>Weight (kg)</label><input type="number" id="donorWeight" required>
        <button type="submit">Register</button>
      </form>
      <p id="donorMessage" style="text-align:center; color:yellow;"></p>
    </div>
  </section>

  <!-- HOSPITAL REGISTER -->
  <section id="hospital-register">
    <div class="form-container">
      <h1>Hospital Registration</h1>
      <form id="hospitalRegisterForm">
        <label>Hospital Name</label><input type="text" id="hospitalName" required>
        <label>Username</label><input type="text" id="hospitalUsername" required>
        <label>Phone</label><input type="text" id="hospitalPhone" required>
        <label>Password</label><input type="password" id="hospitalPassword" required>
        <button type="submit">Register</button>
      </form>
      <p id="registerMessage" style="text-align:center; color:yellow;"></p>
    </div>
  </section>

  <!-- HOSPITAL LOGIN -->
  <section id="hospital-login">
    <div class="form-container">
      <h1>Hospital Login</h1>
      <form id="hospitalLoginForm">
        <label>Username</label><input type="text" id="loginUsername" required>
        <label>Password</label><input type="password" id="loginPassword" required>
        <button type="submit">Login</button>
      </form>
      <p id="loginMessage" style="text-align:center; color:yellow;"></p>

      <div id="searchSection" class="hidden" style="margin-top:25px;">
        <h3>Search Donors by Blood Group</h3>
        <input type="text" id="searchQuery" placeholder="Enter blood group (e.g., O+)" style="width:100%; padding:8px; border-radius:6px;">
        <button id="searchBtn" style="margin-top:10px;">Search</button>
        <ul id="donorResults" style="margin-top:15px; text-align:left;"></ul>
      </div>
    </div>
  </section>

  <footer>&copy; 2025 ANBU THULI | Donate Blood, Save Life</footer>

  <script>
    function showPage(pageId) {
      document.querySelectorAll("section").forEach(sec => sec.classList.remove("active"));
      document.getElementById(pageId).classList.add("active");
    }

    // --- Donor Register ---
    document.getElementById("donorForm").addEventListener("submit", async (e) => {
      e.preventDefault();
      const donor = {
        fullName: donorName.value,
        age: donorAge.value,
        bloodGroup: donorBloodGroup.value,
        phone: donorPhone.value,
        password: donorPassword.value,
        weight: donorWeight.value
      };
      try {
        const res = await fetch("/api/donors/register", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(donor)
        });
        const data = await res.json();
        donorMessage.textContent = data.message || "Registration complete!";
      } catch {
        donorMessage.textContent = "⚠️ Server Error. Please try again.";
      }
    });

    // --- Hospital Register ---
    document.getElementById("hospitalRegisterForm").addEventListener("submit", async (e) => {
      e.preventDefault();
      const hospital = {
        name: hospitalName.value,
        username: hospitalUsername.value,
        phone: hospitalPhone.value,
        password: hospitalPassword.value
      };
      try {
        const res = await fetch("/api/hospitals/register", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(hospital)
        });
        const data = await res.json();
        registerMessage.textContent = data.message || "Hospital registered!";
      } catch {
        registerMessage.textContent = "⚠️ Server Error. Please try again.";
      }
    });

    // --- Hospital Login ---
    document.getElementById("hospitalLoginForm").addEventListener("submit", async (e) => {
      e.preventDefault();
      const credentials = {
        username: loginUsername.value,
        password: loginPassword.value
      };
      try {
        const res = await fetch("/api/hospitals/login", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(credentials)
        });
        const data = await res.json();
        if (data.token) {
          loginMessage.textContent = "✅ Login successful!";
          document.getElementById("searchSection").classList.remove("hidden");
        } else {
          loginMessage.textContent = data.message || "Invalid credentials.";
        }
      } catch {
        loginMessage.textContent = "⚠️ Server Error. Please try again.";
      }
    });

    // --- Donor Search ---
    document.getElementById("searchBtn").addEventListener("click", async () => {
      const query = searchQuery.value.trim();
      if (!query) return alert("Please enter a blood group.");
      try {
        const res = await fetch(`/api/donors/search?q=${encodeURIComponent(query)}`);
        const donors = await res.json();
        donorResults.innerHTML = donors.length
          ? donors.map(d => `<li>${d.fullName} - ${d.bloodGroup} - ${d.phone}</li>`).join("")
          : "<li>No donors found.</li>";
      } catch {
        alert("⚠️ Server Error while searching donors.");
      }
    });
  </script>
</body>
</html>
